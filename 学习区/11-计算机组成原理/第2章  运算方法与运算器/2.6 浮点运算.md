---
命名: __2.6 浮点运算
课程:
  - "[[第2章  运算方法与运算器]]"
状态: 计划中
执行人: 蔡蔡鸿宇
时间安排: Invalid date
待解决问题: 待解决:[ 0 ]
created: 2025-04-01T18:03
updated: 2025-04-08T16:40
---

# 2.6 浮点运算

## 2.6.1 浮点运算基础
### 2.6.1.1 IEEE 754 标准格式
- **定义**：浮点数=符号位 S + 阶码 E + 尾数 M
  $$
 Value = (-1)^S \times 1.M \times 2^{E-bias}
$$

- **常见格式**：

| 类型       | 总位数 | 符号位 | 阶码位数 | 尾数位数 | 偏移量  |
| -------- | --- | --- | ---- | ---- | ---- |
| 单精度 (32) | 32  | 1   | 8    | 23   | 127  |
| 双精度 (64) | 64  | 1   | 11   | 52   | 1023 |

- **示例**（单精度）：
  ```cpp
  0x40490FDB → 
  S=0, E=10000000(128), M=1.10010010000111111011011
  Value = 1.1001001... × 2^(128-127) ≈ 3.14159
  ```

### 2.6.1.2 运算流程
1. 对阶 → 2. 尾数运算 → 3. 规格化 → 4. 舍入 → 5. 溢出判断
   ```mermaid
   graph TD
     A[操作数检查] --> B[对阶]
     B --> C[尾数加减/乘除]
     C --> D[规格化]
     D --> E[舍入处理]
     E --> F[溢出判断]
   ```

## 2.6.2 浮点加减运算
### 2.6.2.1 对阶操作
- **原则**：小阶向大阶对齐
- **方法**：
  ```python
  delta_E = Ex - Ey
  if delta_E > 0:
      My >>= delta_E  # 右移尾数
      Ey = Ex
  else:
      Mx >>= -delta_E
      Ex = Ey
  ```
- **示例**：
  ```
  x = 1.011×2^5, y = 1.110×2^3 → 
  y调整后：0.0111×2^5
  ```

### 2.6.2.2 尾数运算
- **加减规则**：
  - 使用补码运算
  - 符号位单独处理
- **硬件实现**：
  [CSDN技术社区](https://blog.csdn.net/qq_27198345/article/details/116028171)指出需注意尾数位扩展

## 2.6.3 浮点乘除运算
### 2.6.3.1 乘法算法
1. 阶码相加并修正偏移量
   $$
 E_{result} = E_x + E_y - bias
$$
2. 尾数采用定点乘法器计算
   $$
 M_{result} = M_x \times M_y
$$
3. 规格化示例：
   ```
   1.1×2^3 × 1.1×2^5 = 10.01×2^8 → 
   需右规：1.001×2^9
   ```

### 2.6.3.2 除法算法
1. 阶码相减并修正偏移量
   $$
 E_{result} = E_x - E_y + bias
$$
2. 尾数采用不恢复余数除法
   - 硬件成本对比：
```agtable
tableId: 250401060421
     | 实现方式          | 延迟    | 硬件复杂度 |
     |-------------------|---------|------------|
     | 软件模拟          | 100+周期 | 低         |
     | 阵列除法器        | 3 (n+1)²T | 高         |
```


## 2.6.4 特殊处理
### 2.6.4.1 舍入模式
| 模式          | 规则                      | 应用场景         |
|---------------|---------------------------|------------------|
| 就近舍入 (RN)  | 四舍六入五成双            | 通用计算         |
| 向零舍入 (RZ)  | 直接截断                  | 快速计算         |
| 向+∞舍入 (RU)  | 正向数进位，负向数截断    | 区间算术         |

### 2.6.4.2 溢出处理
- **阶码上溢**：标记为±∞
- **阶码下溢**：返回非规格化数或 0
- 根据[维基百科](https://zh.wikipedia.org/wiki/每秒浮点运算次数)，现代处理器通过状态寄存器处理异常

> 注：所有运算需符合 IEEE 754 标准规定的异常处理流程，参考[英特尔官方文档](https://www.intel.com/content/www/cn/zh/docs/programmable/683832/19-3/adder-or-subtractor-for-fixed-point.html)的硬件实现建议。涉及规格化时需注意隐藏位处理（1. M 形式）。
```