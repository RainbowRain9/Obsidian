---
created time: 2024-04-17 22:40:16
updated time: 2024-04-17 22:42:00
dtype: 概念
subject: C++
tags:
  - review
dg-publish: true
banner: https://source.unsplash.com/900x1600/?tree
banner_icon: 🧠
created: 2024-04-17T22:40
updated: 2025-01-12T19:57
---

# 静态变量

在C++中，静态变量是一个特殊的变量，它与普通局部变量不同，具有在函数调用结束后仍然保持其值的特性。这意味着静态变量的值在程序的整个生命周期内是持续存在的。

## 定义

当在函数内部声明一个变量并使用`static`关键字时，该变量就成为了静态变量。静态变量的初始化只在第一次调用函数时执行，之后的函数调用中，静态变量会保留前一次调用结束时的值。

## 特点

- **保留值**：静态变量在函数调用结束后保持其值。
- **作用域**：静态变量的作用域是定义它的函数，它只能在该函数内部被访问。
- **生命周期**：静态变量的生命周期与程序的生命周期相同，从程序开始运行直到结束。
- **初始化**：静态变量在第一次调用函数时初始化，之后调用该函数时不会重新初始化。

## 示例

```C++
#include <iostream>
using namespace std;

int f() 
{
    static int y = 1; // 静态变量
    int x = 1;       // 普通局部变量
    x = x + 2;
    y = y + 2;
    return x + y;
}

int main() 
{
    cout << f() << endl; // 第一次调用f，输出6
    cout << f() << endl; // 第二次调用f，输出8
    return 0;
}
```

在这个例子中，第一次调用`f()`时，`x`和`y`都初始化为1，然后各自加2，返回的结果是6。第二次调用`f()`时，`x`重新初始化为1，但`y`保留了上一次的值3，最终结果是8。

## 运行结果

```
6
8
```

静态变量常用于计数器或需要在多次函数调用之间保持状态的场景。然而，由于静态变量的生命周期较长，使用不当可能会导致程序中难以发现的错误，因此在多线程环境下需要特别注意同步问题。

