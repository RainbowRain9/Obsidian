---
命名: __3.2差错检测和纠正
课程:
  - "[[第3章 数据链路层]]"
状态: 完成
执行人: 蔡蔡鸿宇
时间安排: Invalid date
待解决问题: 待解决:[ 0 ]
created: 2025-04-07T08:18
updated: 2025-04-07T09:01
---

# 3.2 差错检测和纠正

## 3.2.1 循环冗余检验码（CRC）

### 定义与原理
循环冗余检验码（Cyclic Redundancy Check，CRC）是一种通过多项式除法实现差错检测的校验码机制，广泛应用于计算机局域网等环境[^1]。

**数学表达式**：
$$
 F(x) = 2^nM(x) \mod P(x) 
$$
其中：
- $M(x)$：原始数据多项式
- $P(x)$：生成多项式
- $F(x)$：帧检验序列（FCS）

**核心特征**：
- 检错能力强（可检测所有奇数位错误和突发错误）
- 实现效率高（硬件/软件均可快速计算）
- 校验位长度灵活（根据生成多项式决定）

### 工作流程
1. **发送端**：
   ```cpp
   // 伪代码示例：CRC计算
   uint32_t crc32(const byte* data, size_t length) {
       uint32_t crc = 0xFFFFFFFF;
       for (size_t i = 0; i < length; ++i) {
           crc ^= data[i];
           for (int j = 0; j < 8; ++j) {
               crc = (crc >> 1) ^ (0xEDB88320 & -(crc & 1));
           }
       }
       return ~crc;
   }
   ```

2. **接收端验证**流程：
   ```mermaid
   graph LR
   A[接收帧数据] --> B[计算CRC余数]
   B --> C{余数为0?}
   C -->|是| D[接受帧]
   C -->|否| E[丢弃帧]
   ```

### 典型生成多项式
| 标准类型       | 多项式表达式              | 应用场景         |
|----------------|---------------------------|------------------|
| CRC-16         | $X^{16} + X^{15} + X^2 +1$| 工业控制         |
| CRC-CCITT      | $X^{16}+X^{12}+X^5+1$     | 通信协议         |
| CRC-32         | 见下方完整表达式           | 以太网/压缩文件  |

完整CRC-32多项式：
$$
 X^{32} + X^{26} + X^{23} + X^{22} + X^{16} + X^{12} + X^{11} + X^{10} + X^8 + X^7 + X^5 + X^4 + X^2 + X + 1 
$$

---

## 3.2.2 奇偶校验

### 校验类型对比

| 类型               | 校验单位   | 冗余位位置       | 检测能力         |
|--------------------|------------|------------------|------------------|
| 垂直奇偶校验       | 单个字符   | 字符末尾         | 单个奇数位错误   |
| 水平奇偶校验       | 字符组     | 组内相同位       | 突发错误         |
| 水平垂直奇偶校验   | 字符与字符组| 双重校验位      | 二维错误定位     |

**垂直奇偶校验示例**（7位ASCII码+1位校验位）：
```
字符 'A' (65): 01000001（偶校验）
计算规则：
1的个数=2（偶数）→校验位=0
```

### 水平垂直校验实现

| 字符 | 位1 | 位2 | 位3 | 垂直校验位 |
|------|-----|-----|-----|------------|
| A    | 0   | 1   | 1   | 0          |
| B    | 1   | 0   | 1   | 0          |
| 水平校验 | 1   | 1   | 0   | 0          |

---

## 3.2.3 海明码

### 基本定理
满足纠错需求的冗余位数$k$与信息位数$m$需符合：
$$
 m + k + 1 \leq 2^k 
$$

**示例**：对于9位信息位：
- 计算得$k=4$（因$9+4+1=14 \leq 16=2^4$）
- 总编码长度=13位（9信息位+4冗余位）

### 编码结构
| 位号 | 1 (r1) | 2 (r2) | 3 (d1) | 4 (r3) | 5 (d2) |... | 13 (d9) |
|------|--------|--------|--------|--------|--------|-----|---------|
| 值   | 0      | 0      | 1      | 1      | 1      |... | 0       |

**监督关系式**：
- r1校验位覆盖位号$3,5,7,9,11,13$
- r2校验位覆盖位号$3,6,7,10,11$
- r4校验位覆盖位号$5,6,7,12,13$
- r8校验位覆盖位号$9,10,11,12,13$

### 纠错过程
当检测到错误时：
1. 计算各校验位异或值
2. 将出错校验位号组合为二进制
3. 定位错误位并取反修正

示例错误检测：
```plaintext
假设接收数据中第10位出错：
r2=1 (异常), r8=1 (异常) → 错误位置=1010₂=10
```

---

[^1]: 数据来源：计算机网络-第3章数据链路层.pptx，DIX Ethernet2标准