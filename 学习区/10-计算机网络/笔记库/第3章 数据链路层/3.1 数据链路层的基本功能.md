---
命名: __3.1 数据链路层的基本功能
课程:
  - "[[第3章 数据链路层]]"
状态: 完成
创建时间: Invalid date
执行人: 蔡蔡鸿宇
时间安排: Invalid date
待解决问题: 待解决:[ 0 ]
created: 2025-03-29T21:52
updated: 2025-04-07T09:01
---
> [!important]

> [!important]

# 3.1 数据链路层的基本功能

## 3.1.1 成帧

### 定义与作用

- **成帧**：将网络层传递的 **IP数据报** 添加首部和尾部，封装为帧进行传输。
- **目的**：
    - 标识数据边界，确保接收方能正确解析数据。
    - 支持链路层协议规定的传输规则（如MTU限制）。

### 帧的组成

- **首部**：源/目的地址、控制信息（如同步码）。
- **数据部分**：来自网络层的原始数据（不超过MTU）。
- **尾部**：校验码（如CRC）等。
- **总长度** = 首部 + 数据部分 + 尾部。

### 最大传送单元（MTU）

- 每种链路层协议规定的数据部分最大长度。
- **示例**：以太网默认 MTU 为 **1500字节**。
- **影响**：超过 MTU 的数据需分片传输。

### 帧定界方法

1. **控制字符法**：
    - 使用特殊字符（如 `SOH`、`EOT`）标记帧的起始和结束。
    - **示例**:

| 控制字符 | 二进制表示    | 功能                   |
| ---- | -------- | -------------------- |
| SOH  | 00000001 | 帧开始（Start of Header） |
| ETX  | 00000011 | 数据结束（End of Text）    |

2. **字节填充**：
    - 若数据中出现定界符，通过转义字符（如 `0x7D`）解决透明传输问题。
    - **示例**：`0x7E` → `0x7D 0x5E`，`0x7D` → `0x7D 0x5D`。
3. **零比特填充**：
    - 在同步传输中，每遇到 5 个连续 `1` 插入一个 `0`，接收端反向操作。

### 透明传输问题与解决方案

- **问题**：数据部分包含与定界符相同的字符，导致接收方误判帧边界。
- **解决方案**：
    - **字节填充**：转义特殊字符。
    - **零比特填充**：插入并删除填充比特。

---

## 3.1.2 差错控制

### 检错与纠错机制

1. **检错码**：检测数据是否出错（如 CRC、奇偶校验）。
2. **纠错码**：定位并纠正错误（如海明码）。

### 循环冗余检验（CRC）

- **原理**：
    - 发送端将数据除以生成多项式，余数作为校验码附加到帧中。
    - 接收端重新计算余数，若余数非零则判定出错。
- **生成多项式**：
    - CRC-16: $X^{16} + X^{15} + X^2 + 1$
    - CRC-32: $X^{32} + X^{26} + X^{23} + \cdots + X + 1$

### 奇偶校验

- **垂直奇偶校验**：为每个字符添加 1 位校验位，使 `1` 的个数为奇数（奇校验）或偶数（偶校验）。
- **水平奇偶校验**：对一组字符的相同位进行校验。
- **水平垂直奇偶校验**：同时进行水平和垂直校验。

### 海明码

- **原理**：通过冗余位定位错误位置。
- **公式**：满足 $m + k + 1 \leq 2^k$，其中 `m` 为信息位数，`k` 为冗余位数。
- **示例**（9位信息位）：

| 位号  | 1 (r1) | 2 (r2) | 3 (d1) | 4 (r3) | 5 (d2) | 6 (d3) | 7 (d4) | 8 (r4) | 9 (d5) |
| --- | ------ | ------ | ------ | ------ | ------ | ------ | ------ | ------ | ------ |
| 值   | 0      | 0      | 1      | 1      | 1      | 0      | 1      | 1      | 0      |

---

## 3.1.3 流量控制

### 定义与目的

- **流量控制**：协调发送方和接收方的数据处理速率，避免接收方因缓冲区溢出导致数据丢失。
- **关键目标**：提高信道利用率，避免资源浪费。

### 实现方式

1. **停-等协议**：
    - 发送方每发送一帧后等待确认，超时未收到确认则重传。
    - **缺点**：信道利用率低。
2. **滑动窗口协议**：
    - **回退 N 帧（Go-Back-N）**：
        - 允许连续发送多个帧，出错时重传从错误帧开始的所有未确认帧。
        - **示例**：窗口大小为 4，若第 3 帧出错，重传 3、4、5 帧。
    - **选择重传（Selective Repeat）**：
        - 仅重传出错帧，接收方缓存失序帧。
        - **特点**：需维护接收窗口，复杂度较高。

### 关键参数

- **窗口大小**：决定可连续发送的未确认帧数量。
- **超时时间**：根据往返时延（RTT）动态调整。

### 应用场景

- 高层协议（如 TCP）使用滑动窗口机制实现端到端流量控制。
- **协议对比**：

| 协议     | 优点         | 缺点         |
| ------ | ---------- | ---------- |
| 停-等协议  | 实现简单       | 信道利用率低     |
| 回退 N 帧 | 提高吞吐量      | 错误时需重传大量数据 |
| 选择重传   | 仅重传错误帧，效率高 | 实现复杂，需额外缓存 |