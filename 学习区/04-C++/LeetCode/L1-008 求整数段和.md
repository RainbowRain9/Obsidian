# L1-008 求整数段和

## 一、前置知识

-   **基础 C++ 语法:**
    -   变量声明与初始化 (`int a, b, sum = 0, cnt = 0;`)
    -   输入输出流 (`cin`, `cout`)
    -   `printf` 函数用于格式化输出
    -   `for` 循环结构
-   **基本算术运算:** 加法 (`+=`)
-   **格式化输出:**
    -   `printf("%5d", value)`: 输出一个整数 `value`，占用 5 个字符宽度，右对齐。如果数字不足 5 位，左边会用空格填充。

## 二、题目分析

### 1. 题目描述

-   **题目链接:** [L1-008 求整数段和](https://pintia.cn/problem-sets/994805046380707840/exam/problems/994805135224455168)
-   **本地链接:** [L1-008-求整数段和.cpp](../Algorithm/PTA/L1-008-求整数段和.cpp)
-   **难度级别:** 基础
-   **相关标签:** 循环、格式化输出、模拟

### 2. 题目要求

-   **输入:** 一行，包含两个整数 A 和 B，以空格分隔。 \( -100 \le A \le B \le 100 \)
-   **输出:**
    1.  顺序输出从 A 到 B 的所有整数。
    2.  每 5 个数字占一行。
    3.  每个数字占用 5 个字符宽度，向右对齐。
    4.  最后单独一行输出所有这些整数的和，格式为 `Sum = X`。

### 3. 关键概念

-   **整数段:** 从 A 到 B（包含 A 和 B）的所有连续整数。
-   **格式化输出:** 控制每个数字的显示宽度和对齐方式。
-   **换行控制:** 每输出 5 个数字需要换行。注意最后一行可能不足 5 个数字，但之后也要换行。
-   **求和:** 计算指定范围内所有整数的总和。

## 三、示例分析

### 1. 基本示例

```
输入：-3 8
输出：
   -3   -2   -1    0    1
    2    3    4    5    6
    7    8
Sum = 30
```

**图解:**

```
A = -3, B = 8
Loop:
i = -3: print "   -3", sum = -3, cnt = 1
i = -2: print "   -2", sum = -5, cnt = 2
i = -1: print "   -1", sum = -6, cnt = 3
i =  0: print "    0", sum = -6, cnt = 4
i =  1: print "    1", sum = -5, cnt = 5, (cnt % 5 == 0) -> print "\n"
i =  2: print "    2", sum = -3, cnt = 6
i =  3: print "    3", sum =  0, cnt = 7
i =  4: print "    4", sum =  4, cnt = 8
i =  5: print "    5", sum =  9, cnt = 9
i =  6: print "    6", sum = 15, cnt = 10, (cnt % 5 == 0) -> print "\n"
i =  7: print "    7", sum = 22, cnt = 11
i =  8: print "    8", sum = 30, cnt = 12, (i == B) -> print "\n"
End loop.
Print "Sum = 30"
```

**解释:**
代码从 -3 开始循环到 8。
-   `printf("%5d", i)` 保证每个数字（如 -3）输出时占 5 个字符宽度且右对齐（"   -3"）。
-   使用计数器 `cnt` 记录输出了多少个数字。
-   当 `cnt` 是 5 的倍数时（`cnt % 5 == 0`），输出换行符 `\n`。
-   当循环到达最后一个数字 B 时（`i == B`），即使 `cnt` 不是 5 的倍数，也需要输出换行符，确保 `Sum = X` 在新的一行开始。
-   循环过程中累加 `sum`。
-   循环结束后，输出 `Sum = ` 加上计算得到的 `sum` 值。

### 2. 特殊情况

```
输入：1 5
输出：
    1    2    3    4    5
Sum = 15
```

**分析:** 总共只有 5 个数字，输出一行后，因为 `i == B` (i=5)，所以换行，然后输出 Sum。

```
输入：1 4
输出：
    1    2    3    4
Sum = 10
```

**分析:** 总共 4 个数字，不足 5 个，输出一行后，因为 `i == B` (i=4)，所以换行，然后输出 Sum。

### 3. 边界测试

```
输入：-100 100
输出：
(输出共 (100 - (-100) + 1) = 201 个数字，每行5个，共41行)
  -100  -99  -98  -97  -96
  ... (省略中间行) ...
   96   97   98   99  100
Sum = 0
```

**说明:** 测试了输入范围的边界。从 -100 到 100 的和为 0。需要确保循环和格式化能正确处理负数和三位数。

## 四、解题思路

### 1. 问题分析

-   **问题的本质:** 遍历一个整数区间，按指定格式输出每个数，并计算区间内所有数的和。
-   **可能的解决方案:**
    1.  **循环模拟:** 使用 `for` 循环从 A 迭代到 B，在循环体内处理打印、换行和累加。这是最直观的方法，并且题目要求逐个打印，所以必须遍历。
    2.  **数学公式求和:** 可以用等差数列求和公式 `(A + B) * (B - A + 1) / 2` 直接计算和。但题目要求打印过程，所以不能单独使用此方法求和，但可以用来验证循环累加结果的正确性。
-   **方案比较:** 循环模拟是必需的，因为它满足了打印所有数字的要求。

### 2. 算法设计

-   **核心算法:** 迭代（`for` 循环）。
-   **数据结构:** 无需特殊数据结构，使用基本整型变量即可。
-   **优化思路:** 无明显优化空间，因为必须遍历并打印每个数字。

### 3. 解题步骤

1.  **读取输入:** 使用 `cin` 读取整数 A 和 B。
2.  **初始化:** 初始化累加和 `sum = 0`，初始化计数器 `cnt = 0` (用于控制换行)。
3.  **循环遍历:** 使用 `for` 循环，变量 `i` 从 A 迭代到 B (包含 B)。
    -   **格式化输出:** 在循环体内，使用 `printf("%5d", i);` 输出当前数字 `i`，确保 5 位宽度右对齐。
    -   **累加求和:** 将当前数字 `i` 加到 `sum` 上：`sum += i;`。
    -   **计数递增:** `cnt++;`
    -   **判断换行:** 检查是否需要换行。换行的条件是：
        -   已经输出了 5 个数字 (`cnt % 5 == 0`)。
        -   或者，当前是最后一个数字 (`i == b`)。
        -   如果满足任一条件，则输出换行符 `printf("\n");`。
4.  **输出总和:** 循环结束后，使用 `cout` 输出 `Sum = ` 和 `sum` 的值，并换行。

## 五、代码实现

### 1. 完整代码

```cpp
/*
 * @Author: RainbowRain9
 * @Date: 2025-04-02 15:47:33
 * @LastEditTime: 2025-04-02 16:04:20
 * @FilePath: \C++\Algorithm\PTA\L1-008-求整数段和.cpp
 * @Description: https://pintia.cn/problem-sets/994805046380707840/exam/problems/type/7?problemSetProblemId=994805135224455168&page=0
 */
#include <iostream>
#include <cstdio> // 包含 printf 函数

using namespace std;

/**
 * @brief 主函数，解决 PTA L1-008 求整数段和问题
 * @param 无
 * @return 0 表示程序正常结束
 */
int main()
{
    int a, b; // 定义输入的区间端点 A 和 B
    cin >> a >> b; // 读取 A 和 B

    int sum = 0; // 初始化总和为 0
    int cnt = 0; // 初始化计数器为 0，用于控制换行

    // 使用 for 循环遍历从 A 到 B 的所有整数
    for (int i = a; i <= b; i++)
    {
        // 格式化输出当前整数 i，占用 5 个字符宽度，右对齐
        printf("%5d", i);

        // 将当前整数 i 累加到总和 sum 中
        sum += i;

        // 计数器加 1
        cnt++;

        // 判断是否需要换行
        // 条件1: cnt 是 5 的倍数 (已经输出了 5 个数)
        // 条件2: i 等于 B (当前是最后一个数)
        // 满足任一条件都需要换行
        if (cnt % 5 == 0 || i == b)
        {
            printf("\n"); // 输出换行符
        }
    }

    // 输出总和，格式为 "Sum = X"
    cout << "Sum = " << sum << endl;

    return 0; // 程序正常结束
}

```

### 2. 关键代码段解析

```cpp
// 格式化输出当前整数 i，占用 5 个字符宽度，右对齐
printf("%5d", i);
```

-   `printf` 是 C 风格的格式化输出函数。
-   `%5d` 是格式说明符：
    -   `%d` 表示输出一个十进制整数。
    -   `5` 表示最小字段宽度为 5。如果输出的数字不足 5 位，默认会在左侧填充空格以达到 5 位宽度。由于默认是右对齐，所以数字会靠右显示。

```cpp
// 判断是否需要换行
// 条件1: cnt 是 5 的倍数 (已经输出了 5 个数)
// 条件2: i 等于 B (当前是最后一个数)
// 满足任一条件都需要换行
if (cnt % 5 == 0 || i == b)
{
    printf("\n"); // 输出换行符
}
```

-   `cnt % 5 == 0`: 判断已输出的数字个数是否为 5 的倍数。如果是，则当前数字是该行的第 5 个，需要换行。
-   `i == b`: 判断当前是否为循环的最后一个数字。如果是，无论这一行输出了多少个数字（可能是 1 到 5 个），都需要换行，以便 `Sum = X` 从新的一行开始。
-   `||`: 逻辑或运算符，只要两个条件中有一个满足，就会执行换行操作。

### 3. 代码优化

-   对于这个问题，由于必须打印每个数字，循环遍历是必要的，代码已经非常简洁高效，没有太多优化空间。
-   可以考虑将 `printf` 替换为 C++ 的 `<iomanip>` 库中的 `setw` 和 `right` 来实现格式化输出，但这会稍微增加代码复杂度，对于此题 `printf` 更简洁。

```cpp
// 使用 iostream 和 iomanip 实现格式化输出（替代 printf）
#include <iostream>
#include <iomanip>

// ... 在循环内 ...
// cout << right << setw(5) << i;
// ...
// if (cnt % 5 == 0 || i == b) {
//     cout << endl;
// }
// ...
```

## 六、模拟代码过程

### 1. 执行流程 (以输入 -3 8 为例)

1.  **输入:** `a = -3`, `b = 8`
2.  **初始化:** `sum = 0`, `cnt = 0`
3.  **循环开始:**
    -   `i = -3`: `printf("%5d", -3)` 输出 "   -3"; `sum = -3`; `cnt = 1`; `if (1%5==0 || -3==8)` 为假。
    -   `i = -2`: `printf("%5d", -2)` 输出 "   -2"; `sum = -5`; `cnt = 2`; `if (2%5==0 || -2==8)` 为假。
    -   `i = -1`: `printf("%5d", -1)` 输出 "   -1"; `sum = -6`; `cnt = 3`; `if (3%5==0 || -1==8)` 为假。
    -   `i =  0`: `printf("%5d",  0)` 输出 "    0"; `sum = -6`; `cnt = 4`; `if (4%5==0 ||  0==8)` 为假。
    -   `i =  1`: `printf("%5d",  1)` 输出 "    1"; `sum = -5`; `cnt = 5`; `if (5%5==0 ||  1==8)` 为真 (`5%5==0`) -> `printf("\n")` 输出换行。
    -   `i =  2`: `printf("%5d",  2)` 输出 "    2"; `sum = -3`; `cnt = 6`; `if (6%5==0 ||  2==8)` 为假。
    -   `i =  3`: `printf("%5d",  3)` 输出 "    3"; `sum =  0`; `cnt = 7`; `if (7%5==0 ||  3==8)` 为假。
    -   `i =  4`: `printf("%5d",  4)` 输出 "    4"; `sum =  4`; `cnt = 8`; `if (8%5==0 ||  4==8)` 为假。
    -   `i =  5`: `printf("%5d",  5)` 输出 "    5"; `sum =  9`; `cnt = 9`; `if (9%5==0 ||  5==8)` 为假。
    -   `i =  6`: `printf("%5d",  6)` 输出 "    6"; `sum = 15`; `cnt = 10`; `if (10%5==0 || 6==8)` 为真 (`10%5==0`) -> `printf("\n")` 输出换行。
    -   `i =  7`: `printf("%5d",  7)` 输出 "    7"; `sum = 22`; `cnt = 11`; `if (11%5==0 || 7==8)` 为假。
    -   `i =  8`: `printf("%5d",  8)` 输出 "    8"; `sum = 30`; `cnt = 12`; `if (12%5==0 || 8==8)` 为真 (`8==8`) -> `printf("\n")` 输出换行。
4.  **循环结束:** `i` 变为 9，不满足 `i <= b` (9 <= 8)。
5.  **输出总和:** `cout << "Sum = " << 30 << endl;` 输出 "Sum = 30"。
6.  **程序结束。**

### 2. 图示说明

```mermaid
graph TD
    A[开始] --> B(读入 a, b);
    B --> C{初始化 sum=0, cnt=0};
    C --> D{i = a};
    D -- i <= b --> E{printf("%5d", i)};
    E --> F{sum += i};
    F --> G{cnt++};
    G --> H{cnt % 5 == 0 或 i == b ?};
    H -- 是 --> I{printf("\n")};
    H -- 否 --> J{i++};
    I --> J;
    J --> D;
    D -- i > b --> K{cout << "Sum = " << sum << endl};
    K --> L[结束];
```

### 3. 调试技巧

-   **检查格式:** 如果输出格式错误，仔细检查 `printf("%5d", i);` 是否正确写入。
-   **检查换行:** 如果换行不正确，检查 `if (cnt % 5 == 0 || i == b)` 的逻辑。可以在 `if` 语句内外打印 `cnt` 和 `i` 的值进行调试。
    ```cpp
    // cout << "Debug: i=" << i << ", cnt=" << cnt << endl; // 放在 if 前
    if (cnt % 5 == 0 || i == b)
    {
        // cout << "Debug: Newline triggered." << endl; // 放在 if 内
        printf("\n");
    }
    ```
-   **检查总和:** 如果 `Sum` 计算错误，可以在循环中打印 `sum` 的中间值，检查累加过程。
    ```cpp
    sum += i;
    // cout << "Debug: current sum=" << sum << endl;
    ```

## 七、复杂度分析

### 1. 时间复杂度

-   **最好情况:** O(1)，如果 A = B，循环只执行一次。
-   **最坏情况:** O(N)，其中 N = B - A + 1，是区间内整数的个数。当 B 和 A 相差最大时（例如 A=-100, B=100, N=201）。
-   **平均情况:** O(N)。循环需要遍历从 A 到 B 的每一个整数。

### 2. 空间复杂度

-   **辅助空间:** O(1)。只使用了 `a`, `b`, `sum`, `cnt`, `i` 等固定数量的几个变量，不随输入规模变化。
-   **递归深度:** O(1)。没有使用递归。
-   **总体空间:** O(1)。

### 3. 优化空间

-   **时间优化:** 无法优化，因为必须遍历并打印每个数。
-   **空间优化:** 已经是 O(1)，无法优化。

## 八、常见错误

### 1. 代码错误

```cpp
// 错误代码 1: 忘记包含 <cstdio> 或 <iostream>
#include <iostream>
// using namespace std; // 或者 std::printf
int main() { printf("%5d", 10); return 0; } // 可能编译错误或链接错误

// 错误代码 2: 格式字符串错误
printf("%d5", i); // 错误，应该是 %5d

// 错误代码 3: 换行逻辑错误 - 只考虑 %5
if (cnt % 5 == 0) { printf("\n"); } // 错误，最后一行可能不足5个，导致Sum不在新行

// 错误代码 4: 换行逻辑错误 - 多余换行
if (cnt % 5 == 0) { printf("\n"); }
if (i == b) { printf("\n"); } // 错误，如果 i==b 且 cnt%5==0，会换两行
```

-   **错误原因:** 1. 缺少头文件。 2. `printf` 格式化字符串语法错误。 3. 换行条件不完整，未处理最后一行。 4. 换行条件重复判断，可能导致多余换行。
-   **修正方法:** 1. 包含 `<cstdio>` (或 `<stdio.h>`)。 2. 使用正确的 `%5d`。 3. 使用 `||` 合并条件 `cnt % 5 == 0 || i == b`。 4. 同上。

### 2. 思路错误

-   **常见误区:** 认为可以用等差数列公式直接求和然后一次性输出。这忽略了逐个打印和格式化输出的要求。
-   **避免方法:** 仔细阅读题目要求，特别是输出格式部分。
-   **检查清单:**
    -   是否从 A 循环到 B（包含两者）？
    -   每个数字是否都用 `%5d` 格式化输出了？
    -   是否每 5 个数字换行？
    -   最后一行（可能不足 5 个）之后是否换行了？
    -   总和 `sum` 是否正确累加了？
    -   最后输出 `Sum = X` 的格式是否正确？

### 3. 调试建议

-   **测试用例设计:**
    -   基本情况：`-3 8`
    -   刚好 5 个数：`1 5`
    -   不足 5 个数：`1 3`
    -   刚好 10 个数：`1 10`
    -   边界情况：`-100 100`, `0 0`, `-5 -1`
    -   包含 0 的情况：`-2 2`
-   **边界情况验证:** 特别注意 A=B 的情况，以及 A 或 B 为负数的情况。
-   **性能分析方法:** 对于此题，复杂度低，一般不需要性能分析。

## 九、扩展思考

### 1. 题目变形

-   **输出格式变化:** 要求输出其他格式，例如用逗号分隔，或者每行输出 N 个数。只需修改 `printf` 格式和换行逻辑中的 `5`。
-   **求平方和/立方和:** 在循环中累加 `i*i` 或 `i*i*i` 而不是 `i`。
-   **更大范围:** 如果 A 和 B 的范围远超 \([-100, 100]\)，需要注意 `sum` 是否会溢出 `int`，可能需要使用 `long long` 类型。

### 2. 面试相关

-   虽然简单，但可能被问到 `printf` 格式化输出的细节。
-   可能被问到时间/空间复杂度。
-   可能被要求用 C++ 的 `iostream` 和 `iomanip` 实现相同功能。

### 3. 实战技巧

-   掌握 `printf` 的常用格式化标志 (`%d`, `%f`, `%s`, `%c`, `%5d`, `%.2f` 等)。
-   熟悉使用计数器控制循环内特定操作频率（如换行）的模式。

## 十、相关题目

### 1. 类似题目

1.  **PTA L1-003 个位数统计:** 需要遍历数字的每一位，类似遍历区间的思想，涉及计数。
2.  **PTA L1-028 判断素数:** 简单的循环判断。
3.  **基础的循环求和/计数问题:** 很多在线平台的基础题库都有此类问题。

### 2. 推荐练习

-   **基础巩固题:**
    -   计算 1 到 N 的和。
    -   打印九九乘法表（涉及嵌套循环和格式化输出）。
-   **提高进阶题:**
    -   处理更大范围的求和（考虑 `long long`）。
    -   涉及更复杂格式化输出的题目。
-   **综合应用题:**
    -   结合数组/向量，对数组元素进行类似的处理和输出。
